import gmpy2

def attack(c1, c2, e1, e2, n):
   # WRITE YOUR CODE HERE!
   # x*e1 + y*e2 = 1
   _, x, y = gmpy2.gcdext(e1, e2)
   if x < 0:
      x = -x
      c1 = gmpy2.invert(c1, n)
   elif y < 0:
      y = -y
      c2 = gmpy2.invert(c2, n)
   return (pow(c1, x, n) * pow(c2, y, n)) % n



n = 103109065902334620226101162008793963504256027939117020091876799039690801944735604259018655534860183205031069083254290258577291605287053538752280231959857465853228851714786887294961873006234153079187216285516823832102424110934062954272346111907571393964363630079343598511602013316604641904852018969178919051627
ct1 = 27986802045732033022419852993635525978880040058860117071655484864259480070279380433837578120046031676442023798716710398905392478828569924500223842772568159517424084570259026599281616052048845009994936090641131136657248157049330825538797172631844962895927650351182341902533288671645286092267149867544688152842
e1 = 15
ct2 = 35879228223724294438913809689907680896276707028526527015080082428780803668142126675853714884126531373779404024918282336791605786659390016589562980668545967737226601218894650929654600216464864947084612227978977961749829638118214589326703093221940569232753322324189970925416535971639377507300741236055601665808
e2 = 13


print ('[+] Started attack...')

message = attack(ct1, ct2, e1, e2, n)

print ('[+] Attack finished!')

print('\nPlaintext: \n ' + bytearray.fromhex(hex(message)[2:]).decode())


